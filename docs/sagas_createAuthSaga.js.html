<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: sagas/createAuthSaga.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: sagas/createAuthSaga.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { call, all, fork, put, takeEvery } from 'redux-saga/effects';
import { isFunction } from 'lodash';
import types, { authActions } from '../actions';

const createSignInWithEmailAndPasswordSaga = firebaseSagas => function* signInWithEmailAndPasswordSaga(action) {
  try {
    const { email, password } = action.payload;
    yield call(firebaseSagas.auth.signInWithEmailAndPassword, email, password);
  } catch (error) {
    yield put(authActions.authFailure(error));
  }
};

const createSignInAnonymously = firebaseSagas => function* signInAnonymously() {
  try {
    yield call(firebaseSagas.auth.signInAnonymously);
  } catch (error) {
    yield put(authActions.authFailure(error));
  }
};

const createSignInWithCustomToken = firebaseSagas => function* signInWithCustomToken(token) {
  try {
    yield call(firebaseSagas.auth.signInWithCustomToken, token);
  } catch (error) {
    yield put(authActions.authFailure(error));
  }
};

const createSignOutSaga = firebaseSagas => function* signOutSaga() {
  try {
    yield call(firebaseSagas.auth.signOut);
  } catch (error) {
    yield put(authActions.authFailure(error));
  }
};

const createAuthChangedSaga = options => function* authChangedSaga(action) {
  const user = action.payload;
  const { onSignInSuccess, onSignOutSuccess } = options;
  if (user &amp;&amp; onSignInSuccess) {
    if (isFunction(onSignInSuccess)) {
      yield put(onSignInSuccess(user)); // ActionCreator
    } else {
      yield put(onSignInSuccess); // Action
    }
  } else if (onSignOutSuccess) {
    if (isFunction(onSignOutSuccess)) {
      yield put(onSignOutSuccess(null)); // ActionCreator
    } else {
      yield put(onSignOutSuccess); // Action
    }
  }
};

const createSyncUserSaga = firebaseSagas => function* syncUserSaga() {
  yield firebaseSagas.auth.syncUser(authActions.authChanged);
};

/**
 * Creates a AuthSaga
 * @function
 * @return {generator} authSaga
 * @example
 * import { createAuthSaga } from 'firebase-sagas';
 *
 * ...
 *
 * const authSaga = createAuthSaga(firebaseSagas, {
 *   signInMethods: [
 *     'signInWithEmailAndPassword',
 *   ],
 *   onSignInSuccess: push('/Todo'), //react-router-redux
 *   onSignOutSuccess: push('/'),
 * });
 */
const createAuthSaga = (firebaseSagas, options) => function* authSaga() {
  const signOutSaga = createSignOutSaga(firebaseSagas);
  const authChangedSaga = createAuthChangedSaga(options);
  const syncUserSaga = createSyncUserSaga(firebaseSagas);
  const signInWithEmailAndPasswordSaga = createSignInWithEmailAndPasswordSaga(firebaseSagas);
  const signInAnonymously = createSignInAnonymously(firebaseSagas);
  const signInWithCustomToken = createSignInWithCustomToken(firebaseSagas);

  yield fork(syncUserSaga);
  yield all([
    takeEvery(types.SIGNIN_WITH_EMAIL_AND_PASSWORD, signInWithEmailAndPasswordSaga),
    takeEvery(types.SIGNIN_ANONYMOUSLY, signInAnonymously),
    takeEvery(types.SIGNIN_WITH_CUSTOM_TOKEN, signInWithCustomToken),
    takeEvery(types.SIGNOUT, signOutSaga),
    takeEvery(types.AUTH_CHANGED, authChangedSaga),
  ]);
};

export default createAuthSaga;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-auth.html">auth</a></li><li><a href="module-constants.html">constants</a></li><li><a href="module-database.html">database</a></li></ul><h3>Classes</h3><ul><li><a href="FirebaseSagas.html">FirebaseSagas</a></li><li><a href="Query.html">Query</a></li></ul><h3>Global</h3><ul><li><a href="global.html#createAuthSaga">createAuthSaga</a></li><li><a href="global.html#createFirebaseSagas">createFirebaseSagas</a></li><li><a href="global.html#createQuery">createQuery</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.0</a> on Fri Aug 04 2017 14:44:12 GMT+0200 (CEST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
